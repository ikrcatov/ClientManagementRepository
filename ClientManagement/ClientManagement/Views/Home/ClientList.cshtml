<head>
    <title>Client List</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <script src="/Scripts/toastr.js" type="text/javascript"></script>
    <script src="/Scripts/toastr.min.js" type="text/javascript"></script>
    <script src="/Scripts/flavr.js" type="text/javascript"></script>
    <script src="/Scripts/flavr.min.js" type="text/javascript"></script>
    <script src="/Scripts/main.js" type="text/javascript"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.1.5/angular.min.js"></script>
    <script src="https://code.angularjs.org/1.3.2/angular-mocks.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.8/angular-route.js"></script>
    <script src="http://angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.6.0.js" type="text/javascript"></script>
    <script src="http://m-e-conroy.github.io/angular-dialog-service/javascripts/dialogs.min.js" type="text/javascript"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

    <link rel="stylesheet" type="text/css" media="screen" href="/Content/toastr.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="/Content/toastr.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="/Content/flavr.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="/Content/flavr.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery.ui.all.css" />
    
    <style type="text/css">
        body {
	        background: #fafafa url(http://jackrugile.com/images/misc/noise-diagonal.png);
	        color: #444;
	        font: 100%/30px 'Helvetica Neue', helvetica, arial, sans-serif;
	        text-shadow: 0 1px 0 #fff;
        }

        strong {
	        font-weight: bold; 
        }

        em {
	        font-style: italic; 
        }

        table {
	        background: #f5f5f5;
	        border-collapse: separate;
	        box-shadow: inset 0 1px 0 #fff;
	        font-size: 12px;
	        line-height: 24px;
	        margin: 30px auto;
	        text-align: left;
	        width: 800px;
        }	

        th {
	        background: url(http://jackrugile.com/images/misc/noise-diagonal.png), linear-gradient(#777, #444);
	        border-left: 1px solid #555;
	        border-right: 1px solid #777;
	        border-top: 1px solid #555;
	        border-bottom: 1px solid #333;
	        box-shadow: inset 0 1px 0 #999;
	        color: #fff;
            font-weight: bold;
	        padding: 10px 15px;
	        position: relative;
	        text-shadow: 0 1px 0 #000;	
        }

        th:after {
	        background: linear-gradient(rgba(255,255,255,0), rgba(255,255,255,.08));
	        content: '';
	        display: block;
	        height: 25%;
	        left: 0;
	        margin: 1px 0 0 0;
	        position: absolute;
	        top: 25%;
	        width: 100%;
        }

        th:first-child {
	        border-left: 1px solid #777;	
	        box-shadow: inset 1px 1px 0 #999;
        }

        th:last-child {
	        box-shadow: inset -1px 1px 0 #999;
        }

        td {
	        border-right: 1px solid #fff;
	        border-left: 1px solid #e8e8e8;
	        border-top: 1px solid #fff;
	        border-bottom: 1px solid #e8e8e8;
	        padding: 10px 15px;
	        position: relative;
	        transition: all 300ms;
        }

        td:first-child {
	        box-shadow: inset 1px 0 0 #fff;
        }	

        td:last-child {
	        border-right: 1px solid #e8e8e8;
	        box-shadow: inset -1px 0 0 #fff;
        }	

        tr {
	        background: url(http://jackrugile.com/images/misc/noise-diagonal.png);	
        }

        tr:last-of-type td {
	        box-shadow: inset 0 -1px 0 #fff; 
        }

        tr:last-of-type td:first-child {
	        box-shadow: inset 1px -1px 0 #fff;
        }	

        tr:last-of-type td:last-child {
	        box-shadow: inset -1px -1px 0 #fff;
        }	

        tbody:hover td {
	        color: transparent;
	        text-shadow: 0 0 3px #aaa;
        }

        tbody:hover tr:hover td {
	        color: #444;
	        text-shadow: 0 1px 0 #fff;
        }

        .class {display: none;}

        .active {
            background-color: #C3E5FA !important;
        }

        .oddClass {
             background: #f1f1f1 url(http://jackrugile.com/images/misc/noise-diagonal.png);	
        }

    </style>

</head>
    
<form id="clientListForm" style="width: 90%; height: 90%;" data-ng-app="clientList" data-ng-controller="clientListController">
    <input id="selectedClientId" data-ng-name="selectedClientId" name="selectedClientId" value="" type="hidden">

    <div id="tableHolder" style="width: 95%; height: 80%; float: left;">
	    <table style="width: 95%; height: 95%;">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>NAME</th>
                </tr>
            </thead>
            <tbody>
                <tr id="clientListTr" data-ng-repeat="user in users" data-ng-class-odd="'oddClass'" data-ng-click="selectedRow($index, user.Id)" data-ng-class="{'active': $index == selectedId}">
                    <td data-ng-bind="user.Id"></td>
                    <td data-ng-bind="user.NAME"></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div id="buttonsHolder" style="width: 95%; height: 20%; text-align: center; margin-left: -195px; float: left;">
        <input type="button" class="btnLogin" value="Add" />
        <input type="button" class="btnLogin" value="Delete" />
        <input type="button" class="btnLogin" id="edit" data-ng-click="edit();" value="Edit" />
        <input type="submit" class="btnLogin" id="logOut" data-ng-click="logOut();" value="Log Out" />
    </div>

    <modal title="Login form" visible="showModal" data-ng-class="{'class': showModal == false}">
        <form role="form">
            <div class="form-group">
                <label for="email">Email address</label>
                <input type="email" class="form-control" id="email" placeholder="Enter email" />
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" class="form-control" id="password" placeholder="Password" />
            </div>
            <button type="submit" class="btn btn-default">Submit</button>
        </form>
  </modal>

</form>

<script type="text/javascript">
    
    var app = angular.module('clientList', []);

    app.directive('modal', function () {
        return {
            template: '<div class="modal fade">' +
                '<div class="modal-dialog">' +
                  '<div class="modal-content">' +
                    '<div class="modal-header">' +
                      '<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>' +
                      '<h4 class="modal-title">{{ title }}</h4>' +
                    '</div>' +
                    '<div class="modal-body" ng-transclude></div>' +
                  '</div>' +
                '</div>' +
              '</div>',
            restrict: 'E',
            transclude: true,
            replace: true,
            scope: true,
            link: function postLink(scope, element, attrs) {
                scope.title = attrs.title;

                scope.$watch(attrs.visible, function (value) {
                    if (value == true)
                        $(element).modal('show');
                    else
                        $(element).modal('hide');
                });

                $(element).on('shown.bs.modal', function () {
                    scope.$apply(function () {
                        scope.$parent[attrs.visible] = true;
                    });
                });

                $(element).on('hidden.bs.modal', function () {
                    scope.$apply(function () {
                        scope.$parent[attrs.visible] = false;
                    });
                });
            }
        };
    });

    angular.element(document).ready(function ($scope) {
    });
    
    function clientListController($scope, $http, $location, myService) {
        $scope.users = angular.fromJson($('#usersInHidden').val());

        $scope.showModal = false;

        $scope.selectedRow = function ($index, id) {
            $scope.selectedId = $index;
            $('#selectedClientId').val(id);
            $scope.selectedClientId = id;
        };

        $scope.logOut = function () {
            
            $http.post("@Url.Action("Index")", { "data": "" }).
		        success(function (data, status) {
		            angular.element('#mainBody').html(data);
		        }).error(function (data, status) {
		            $scope.data = data || "Request failed";
		            $scope.status = status;
		        });
        };

        $scope.edit = function () {

            var selectedId = $scope.selectedClientId;
            if (!isVariableEmpty(selectedId)) {
                alert(selectedId);

                $scope.showModal = !$scope.showModal;
            }
        };
    }

    function isVariableEmpty(data) {

        if (data != null && data != 'null' && data != 'undefined' && data != '')
            return false;
        else
            return true;
    }

</script>